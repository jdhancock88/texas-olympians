$(document).ready(function(){function t(t,a){$.each(t,function(t,e){var n=e;n.events=[],$.each(a,function(){var t=this.nextdate.substring(0,10);if(t=v.parse(t),t=h(t),dateTime=t+", "+this.nexttime,jsDate=Date.parse(dateTime),n.name===this.athlete){var e={jsdate:jsDate,event:this.event,next_date:t,next_time:this.nexttime,channel:this.channel,roundresult:this.roundresult,gold:this.gold,silver:this.silver,bronze:this.bronze};n.events.push(e),n.events.sort(function(t,e){var a=new Date(t.jsdate),n=new Date(e.jsdate);return n>a?-1:a>n?1:0});var a;for(i=0;i<n.events.length;i++)n.events[i].jsdate<o&&(a=i);var s=n.events.splice(0,a+1);n.events=n.events.concat(s)}})}),t.sort(function(t,e){var a=new Date(t.events[0].jsdate),n=new Date(e.events[0].jsdate);return n>a?-1:a>n?1:0});var n;for(i=0;i<t.length;i++)t[i].events[0].jsdate<o&&(n=i);var s=t.splice(0,n+1);t=t.concat(s),e(t),r()}function e(t){console.log(t);var e=d3.select("#olympians").selectAll(".athlete").data(t);e.enter().append("div").attr("class",function(t){var e=t.sport.toLowerCase();return"athlete "+e}).attr("data-athlete",function(t){return t.name});var r=(e.append("i").attr("class","fa fa-plus-circle expander"),e.append("img").attr("src",function(t){var e=t.name.toLowerCase();return e=e.replace(/ /g,""),"/images/_"+e+".jpg"}).attr("alt",function(t){return t.name}),e.append("div").attr("class","athContent")),l=r.append("ul").attr("class","medalGroup clearFix");l.append("li").attr("class","gold").text(function(t){return t.gold}),l.append("li").attr("class","silver").text(function(t){return t.silver}),l.append("li").attr("class","bronze").text(function(t){return t.bronze});var d=r.append("div").attr("class","nameBlock clearFix");d.append("img").attr("src",function(t){var e=t.nation.toLowerCase();return e=e.replace(/ /g,""),"images/_"+e+"Flag.jpg"}).attr("alt",function(t){return t.nation}).attr("class","flag"),d.append("h4").html(function(t){return t.name+" <span class='country'>  | "+t.nation+"</span>"});var c=r.append("div").attr("class","bio");c.append("div").attr("class","info").html(function(t){var e="<p class='label'>Age</p>";return e+="<h6>"+t.age+"</h6>"}),c.append("div").attr("class","info").html(function(t){var e="<p class='label'>Texas tie</p>";return e+="<h6>"+t.hometown+"</h6>"}),c.append("div").attr("class","info").html(function(t){var e="<p class='label'>Sport</p>";return e+="<h6>"+t.sport+"</h6>"}),r.append("p").attr("class","blurb").html(function(t){return t.bio});var p=(r.append("table").attr("class","schedule").html(function(t){var e="";for(e+="<p class='label'>Schedule and Results</p>",i=-1;i<t.events.length;i++){var a=!1,n=!1;bronze=!1,i>=0&&("x"===t.events[i].gold?a=!0:"x"===t.events[i].silver?n=!0:"x"===t.events[i].bronze&&(bronze=!0)),-1===i?e+="<tr><th>Event</th><th>Time/Date</th><th>Ch.</th><th>Round/Result</th></tr>":(e+=t.events[i].jsdate>o?"<tr><td>"+t.events[i].event+"</td><td>"+t.events[i].next_time+", "+t.events[i].next_date+"</td><td>"+t.events[i].channel+"</td>":"<tr><td>"+t.events[i].event+"</td><td>Completed</td><td></td>",e+=a===!0?"<td><span class='medal goldMedal'></span>Gold</td></tr>":n===!0?"<td><span class='medal silverMedal'></span>Silver</td></tr>":bronze===!0?"<td><span class='medal bronzeMedal'></span>Bronze</td></tr>":"<td>"+t.events[i].roundresult+"</td></tr>")}return e}),r.append("ul").attr("class","links").html(function(t){var e="";return void 0!==t.link1text&&(e+="<li><a target='_blank' href='"+t.link1url+"'>"+t.link1text+"</a></li>"),void 0!==t.link2text&&(e+="<li><a target='_blank' href='"+t.link2url+"'>"+t.link2text+"</a></li>"),void 0!==t.link3text&&(e+="<li><a target='_blank' href='"+t.link3url+"'>"+t.link3text+"</a></li>"),e}),r.append("div").attr("class","moreOverlay").append("button").attr("class","readMore"));p.html("<i class='fa fa-plus-circle'></i> Read more"),$(".readMore, .expander").click(function(){$(this).closest(".athlete").hasClass("expanded")===!1?(a($(this),"expand"),f.isotope("layout")):(a($(this),"collapse"),f.isotope("layout"));var t=$(this).closest(".athlete");setTimeout(function(){n(t)},525)}),s()}function a(t,e){var a=t.closest(".athlete");"expand"===e?($(".athlete").removeClass("expanded"),$(".athlete").find(".moreOverlay").removeClass("hidden"),$(".expander").removeClass("fa-minus-circle").addClass("fa-plus-circle"),a.find(".expander").removeClass("fa-plus-circle").addClass("fa-minus-circle"),a.find(".moreOverlay").addClass("hidden"),a.addClass("expanded")):"collapse"===e&&(a.find(".expander").removeClass("fa-minus-circle").addClass("fa-plus-circle"),a.find(".moreOverlay").removeClass("hidden"),a.removeClass("expanded"))}function n(t){var e=$(window).height(),a=$(window).scrollTop(),n=t.offset().top;(n>a+(e-100)||a>n)&&$("html, body").animate({scrollTop:n-100},500)}function s(){f=$("#olympians").isotope({layoutMode:"packery",itemSelector:".athlete",precentPosition:!0,transitionDuration:500});var t="basketball";t=".basketball",$("#testButton").click(function(){console.log("test"),f.isotope({filter:t})})}function r(){for(i=0;i<p.length;i++)console.log(p[i].sport),-1===$.inArray(p[i].sport,m)&&m.push(p[i].sport);for(console.log(m),i=0;i<m.length;i++){var t="<option data-selection='"+m[i].toLowerCase()+"'>"+m[i]+"</option>";$("#sports").append(t)}}function l(t,e){filterString="."+t+"."+e,console.log(filterString),f.isotope({filter:filterString})}var o=new Date,d=o.getFullYear();$(".copyright").text(d);var c,p,u=0,v=d3.time.format("%Y-%m-%d"),h=d3.time.format("%b. %d, %Y");$.getJSON("http://interactives.dallasnews.com/data-store/2016/062016-texas-olympians-sked.json",function(e){c=e,u++,2===u&&t(p,c)}),$.getJSON("http://interactives.dallasnews.com/data-store/2016/062016-texas-olympians-athletes.json",function(e){p=e,u++,2===u&&t(p,c)});var f,m=[],g="athlete";$("#sports").change(function(){sportsSelection=$(this).find("option:selected").attr("data-selection"),"all sports"===sportsSelection&&(sportsSelection="athlete"),l(sportsSelection,g)})});
//# sourceMappingURL=scripts-bundle.js.map
