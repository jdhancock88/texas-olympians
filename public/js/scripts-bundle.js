$(document).ready(function(){function e(e,s){$.each(e,function(e,t){var n=t;n.events=[],$.each(s,function(){var e=this.nextdate.substring(0,10);if(e=f.parse(e),e=g(e),dateTime=e+", "+this.nexttime,jsDate=Date.parse(dateTime),n.name===this.athlete){var t={jsdate:jsDate,event:this.event,next_date:e,next_time:this.nexttime,channel:this.channel,roundresult:this.roundresult,gold:this.gold,silver:this.silver,bronze:this.bronze};n.events.push(t),n.events.sort(function(e,t){var n=new Date(e.jsdate),a=new Date(t.jsdate);return a>n?-1:n>a?1:0});var a;for(i=0;i<n.events.length;i++)n.events[i].jsdate<c&&(a=i);var s=n.events.splice(0,a+1);n.events=n.events.concat(s)}})}),e.sort(function(e,t){var n=new Date(e.events[0].jsdate),a=new Date(t.events[0].jsdate);return a>n?-1:n>a?1:0});var r=c.toString().substring(4,15);for(r=m.parse(r),r=g(r),i=0;i<e.length;i++)for(k=0;k<e[i].events.length;k++)e[i].events[k].next_date===r&&x.push(e[i]);x.length>3&&(b=x.splice(3,x.length-3)),console.log(b),t(x,r),n(b,r);var l;for(i=0;i<e.length;i++)e[i].events[0].jsdate<c&&(l=i);var d=e.splice(0,l+1);e=e.concat(d),a(e),o()}function t(e,t){if(e.length>0){var n=d3.select("#nextThree").selectAll(".upNext").data(e);n.enter().append("div").attr("class","upNext clearFix").append("img").attr("src",function(e){var t=e.name.toLowerCase();return t=t.replace(/ /g,""),"images/_"+t+"Mug.jpg"}).attr("alt",function(e){return e.name}).attr("class","nextAthlete"),n.append("h5").text(function(e){return e.name}),n.append("h6").text(function(e){var n;for(i=0;i<e.events.length;i++)e.events[i].next_date===t&&(n=e.events[i].event);return n}),n.append("p").text(function(e){var n;for(i=0;i<e.events.length;i++)e.events[i].next_date==t&&(n=e.events[i].next_time+" today, "+e.events[i].channel);return n})}else $("#scheduleDisplay").remove()}function n(e,t){if(e.length>0){var n=d3.select("#todaysOthers").selectAll(".otherAth").data(e);n.enter().append("div").attr("class","otherAth").append("img").attr("src",function(e){var t=e.name.toLowerCase();return t=t.replace(/ /g,""),"images/_"+t+"Mug.jpg"}).attr("alt",function(e){return e.name}),n.append("span").attr("class","other").html(function(e){var n="";for(i=0;i<e.events.length;i++)e.events[i].next_date===t&&(n+=e.name+", "+e.events[i].event+", "+e.events[i].next_time+", "+e.events[i].channel);return n})}else $("#todaysOthers").remove()}function a(e){console.log(e);var t=d3.select("#olympians").selectAll(".athlete").data(e);t.enter().append("div").attr("class",function(e){var t=e.sport.toLowerCase();return e.bronze>0||e.silver>0||e.gold>0?"athlete medalWinner "+t:"athlete "+t}).classed("bronzeWinner",function(e){return e.bronze>0?!0:void 0}).classed("silverWinner",function(e){return e.silver>0?!0:void 0}).classed("goldWinner",function(e){return e.gold>0?!0:void 0}).attr("data-athlete",function(e){return e.name});var n=(t.append("i").attr("class","fa fa-plus-circle expander"),t.append("img").attr("src",function(e){var t=e.name.toLowerCase();return t=t.replace(/ /g,""),"/images/_"+t+".jpg"}).attr("alt",function(e){return e.name}),t.append("div").attr("class","athContent")),a=n.append("ul").attr("class","medalGroup clearFix");a.append("li").attr("class","gold").text(function(e){return e.gold}),a.append("li").attr("class","silver").text(function(e){return e.silver}),a.append("li").attr("class","bronze").text(function(e){return e.bronze});var o=n.append("div").attr("class","nameBlock clearFix");o.append("img").attr("src",function(e){var t=e.nation.toLowerCase();return t=t.replace(/ /g,""),"images/_"+t+"Flag.jpg"}).attr("alt",function(e){return e.nation}).attr("class","flag"),o.append("h4").html(function(e){return e.name+" <span class='country'>  | "+e.nation+"</span>"});var d=n.append("div").attr("class","bio");d.append("div").attr("class","info").html(function(e){var t="<p class='label'>Age</p>";return t+="<h6>"+e.age+"</h6>"}),d.append("div").attr("class","info").html(function(e){var t="<p class='label'>Texas tie</p>";return t+="<h6>"+e.hometown+"</h6>"}),d.append("div").attr("class","info").html(function(e){var t="<p class='label'>Sport</p>";return t+="<h6>"+e.sport+"</h6>"}),n.append("p").attr("class","blurb").html(function(e){return e.bio});var p=(n.append("table").attr("class","schedule").html(function(e){var t="";for(t+="<p class='label'>Schedule and Results</p>",i=-1;i<e.events.length;i++){var n=!1,a=!1;bronze=!1,i>=0&&("x"===e.events[i].gold?n=!0:"x"===e.events[i].silver?a=!0:"x"===e.events[i].bronze&&(bronze=!0)),-1===i?t+="<tr><th>Event</th><th>Time/Date</th><th>Ch.</th><th>Round/Result</th></tr>":(t+=e.events[i].jsdate>c?"<tr><td>"+e.events[i].event+"</td><td>"+e.events[i].next_time+", "+e.events[i].next_date+"</td><td>"+e.events[i].channel+"</td>":"<tr><td>"+e.events[i].event+"</td><td>Completed</td><td></td>",t+=n===!0?"<td><span class='medal goldMedal'></span>Gold</td></tr>":a===!0?"<td><span class='medal silverMedal'></span>Silver</td></tr>":bronze===!0?"<td><span class='medal bronzeMedal'></span>Bronze</td></tr>":"<td>"+e.events[i].roundresult+"</td></tr>")}return t}),n.append("ul").attr("class","links").html(function(e){var t="<p class='label'>Related content</p>";return void 0!==e.link1text&&(t+="<li><a target='_blank' href='"+e.link1url+"'>"+e.link1text+"</a></li>"),void 0!==e.link2text&&(t+="<li><a target='_blank' href='"+e.link2url+"'>"+e.link2text+"</a></li>"),void 0!==e.link3text&&(t+="<li><a target='_blank' href='"+e.link3url+"'>"+e.link3text+"</a></li>"),t}),n.append("div").attr("class","moreOverlay").append("button").attr("class","readMore"));p.html("<i class='fa fa-plus-circle'></i> Read more"),$(".readMore, .expander").click(function(){$(this).closest(".athlete").hasClass("expanded")===!1?(s($(this),"expand"),C.isotope("layout")):(s($(this),"collapse"),C.isotope("layout"));var e=$(this).closest(".athlete");setTimeout(function(){r(e)},525)}),l()}function s(e,t){var n=e.closest(".athlete");"expand"===t?($(".athlete").removeClass("expanded"),$(".athlete").find(".moreOverlay").removeClass("hidden"),$(".expander").removeClass("fa-minus-circle").addClass("fa-plus-circle"),n.find(".expander").removeClass("fa-plus-circle").addClass("fa-minus-circle"),n.find(".moreOverlay").addClass("hidden"),n.addClass("expanded")):"collapse"===t&&(n.find(".expander").removeClass("fa-minus-circle").addClass("fa-plus-circle"),n.find(".moreOverlay").removeClass("hidden"),n.removeClass("expanded"))}function r(e){var t=$(window).height(),n=$(window).scrollTop(),a=e.offset().top;(a>n+(t-100)||n>a)&&$("html, body").animate({scrollTop:a-100},500)}function l(){C=$("#olympians").isotope({layoutMode:"packery",itemSelector:".athlete",precentPosition:!0,transitionDuration:500});var e="basketball";e=".basketball",$("#testButton").click(function(){console.log("test"),C.isotope({filter:e})})}function o(){for(i=0;i<v.length;i++)console.log(v[i].sport),-1===$.inArray(v[i].sport,y)&&y.push(v[i].sport);for(console.log(y),i=0;i<y.length;i++){var e="<option data-selection='"+y[i].toLowerCase()+"'>"+y[i]+"</option>";$("#sports").append(e)}}function d(e,t){filterString="."+e+"."+t,console.log(filterString),C.isotope({filter:filterString})}var c=new Date,p=c.getFullYear();$(".copyright").text(p);var u,v,h=0,f=d3.time.format("%Y-%m-%d"),m=d3.time.format("%b %d %Y"),g=d3.time.format("%b. %d, %Y"),x=[],b=[];$.getJSON("http://interactives.dallasnews.com/data-store/2016/062016-texas-olympians-sked.json",function(t){u=t,h++,2===h&&e(v,u)}),$.getJSON("http://interactives.dallasnews.com/data-store/2016/062016-texas-olympians-athletes.json",function(t){v=t,h++,2===h&&e(v,u)});var C,y=[],w="athlete";$("#sports").change(function(){sportsSelection=$(this).find("option:selected").attr("data-selection"),d(sportsSelection,w)}),$("#medals").change(function(){w=$(this).find("option:selected").attr("data-selection"),d(sportsSelection,w)})});
//# sourceMappingURL=scripts-bundle.js.map
