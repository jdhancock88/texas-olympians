$(document).ready(function(){function e(e,t){return e=e.substring(0,10),e=x.parse(e),e=t(e)}function t(e,t){_.forEach(e,function(e,a){var n=e;n.events=[],n.events=_.filter(t,function(e){return e.athlete==n.name})}),e.sort(function(e,t){var a=e.name.trim(),n=t.name.trim(),i=a.split(" "),r=n.split(" "),s=i[i.length-1],l=r[r.length-1];return l>s?-1:s>l?1:0});var r=u.toString().substring(4,15);for(r=b.parse(r),r=y(r),i=0;i<e.length;i++)for(k=0;k<e[i].events.length;k++)e[i].events[k].next_date===r&&w.push(e[i]);w=_.uniqBy(w,"name"),a(w,r),n(e,"#olympians"),c()}function a(e,t){if(e.length>0){var a=d3.select("#todaysAths").selectAll(".upNext").data(e);a.enter().append("div").attr("class","upNext clearFix"),a.append("img").attr("src",function(e){var t=e.nation.toLowerCase();return t=t.replace(/ /g,""),"images/_"+t+"Flag.jpg"}),a.append("h6").text(function(e){return e.name}),a.append("p").html(function(e){var a="";for(i=0;i<e.events.length;i++)e.events[i].next_date===t&&"yes"!==e.events[i].completed?a+=e.sport+", "+e.events[i].event+": "+e.events[i].nexttime+", "+e.events[i].channel+". <br />":e.events[i].next_date===t&&"yes"===e.events[i].completed&&(a+=e.sport+", "+e.events[i].event+". <br />");return a})}else $("#scheduleDisplay").remove();$(".upNext h6").click(function(){var e,t=$(this).text();$.each($(".athlete"),function(){$(this).attr("data-athlete")===t&&(e=$(this))}),r(1e3),s(e)})}function n(e,t){var a=d3.select(t).selectAll(".athlete").data(e);a.enter().append("div").attr("class",function(e){var t=e.sport.toLowerCase();t=t.replace(/ |'|&/g,"");var a="";for(j=0;j<e.events.length;j++)thisDate=e.events[j].next_date.toLowerCase(),thisDate=thisDate.replace(/ |,|\./g,""),a+=" "+thisDate;return e.bronze>0||e.silver>0||e.gold>0?"athlete medalWinner "+t+a:"athlete "+t+a}).classed("bronzeWinner",function(e){return e.bronze>0?!0:void 0}).classed("silverWinner",function(e){return e.silver>0?!0:void 0}).classed("goldWinner",function(e){return e.gold>0?!0:void 0}).attr("data-athlete",function(e){return e.name});var n=(a.append("i").attr("class","fa fa-plus-circle expander"),a.append("img").attr("src","images/_defaultImage.jpg"));n.attr("data-src",function(e){var t=e.name.toLowerCase();return t=t.replace(/ /g,""),"images/_"+t+".jpg"}).attr("alt",function(e){return e.name});var l=a.append("div").attr("class","athContent"),o=l.append("ul").attr("class","medalGroup clearFix");o.append("li").attr("class","gold").text(function(e){return e.gold}),o.append("li").attr("class","silver").text(function(e){return e.silver}),o.append("li").attr("class","bronze").text(function(e){return e.bronze});var d=l.append("div").attr("class","nameBlock clearFix");d.append("img").attr("src",function(e){var t=e.nation.toLowerCase();return t=t.replace(/ /g,""),"images/_"+t+"Flag.jpg"}).attr("alt",function(e){return e.nation}).attr("class","flag"),d.append("h4").html(function(e){return e.name}),d.append("h5").attr("class","country").text(function(e){return e.nation});var c=l.append("div").attr("class","bio");c.append("div").attr("class","info").html(function(e){var t="<p class='label'>Age</p>";return t+="<h6>"+e.age+"</h6>"}),c.append("div").attr("class","info").html(function(e){var t="<p class='label'>Texas tie</p>";return t+="<h6>"+e.texastie+"</h6>"}),c.append("div").attr("class","info").html(function(e){var t="<p class='label'>Sport</p>";return t+="<h6>"+e.sport+"</h6>"}),l.append("p").attr("class","blurb").html(function(e){return e.bio});var p=l.append("div").attr("class","schedule");p.append("p").attr("class","label").text("Schedule and Results"),p.append("table").attr("class","scheduleTable").html(function(e){var t="";for(i=-1;i<e.events.length;i++){var a=!1,n=!1;if(bronze=!1,i>=0&&("x"===e.events[i].gold?a=!0:"x"===e.events[i].silver?n=!0:"x"===e.events[i].bronze&&(bronze=!0)),-1===i)t+="<tr><th>Event</th><th>Time/Date</th><th>Ch.</th><th>Round/Place</th></tr>";else{var r=e.events[i].next_date;r=r.slice(0,-6),t+="yes"!==e.events[i].completed?"<tr><td>"+e.events[i].event+"</td><td>"+e.events[i].nexttime+", "+r+"</td><td>"+e.events[i].channel+"</td>":"<tr><td>"+e.events[i].event+"</td><td>Completed</td><td>"+e.events[i].channel+"</td>",t+=a===!0?"<td><span class='medal goldMedal'></span>Gold</td></tr>":n===!0?"<td><span class='medal silverMedal'></span>Silver</td></tr>":bronze===!0?"<td><span class='medal bronzeMedal'></span>Bronze</td></tr>":"<td>"+e.events[i].roundresult+"</td></tr>"}}return t});var h=(l.append("ul").attr("class","links").html(function(e){var t="";return void 0!==e.link1text&&(t+="<p class='label'>Related content</p>",t+="<li><a target='_blank' href='"+e.link1url+"'>"+e.link1text+"</a></li>"),void 0!==e.link2text&&(t+="<li><a target='_blank' href='"+e.link2url+"'>"+e.link2text+"</a></li>"),void 0!==e.link3text&&(t+="<li><a target='_blank' href='"+e.link3url+"'>"+e.link3text+"</a></li>"),t}),l.append("div").attr("class","moreOverlay").append("button").attr("class","readMore"));h.html("<i class='fa fa-plus-circle'></i> Read more"),$(".readMore, .expander").click(function(){var e=$(this).closest(".athlete");s(e)}),r(z)}function r(e){for(e>$(".athlete").length-1&&(e=$(".athlete").length-1,$("#moreButtons").addClass("noShow")),i=0;i<=e;i++){var t=$(".athlete").eq(i).children("img").attr("data-src");$(".athlete").eq(i).addClass("visible").children("img").attr("src",t)}e<$(".athlete").length-1?z+=12:$("#loadMore").remove(),d()}function s(e){e.hasClass("expanded")===!1?(l(e,"expand"),M.isotope("layout")):(l(e,"collapse"),M.isotope("layout"));var t=e;setTimeout(function(){o(t)},525)}function l(e,t){"expand"===t?($(".athlete").removeClass("expanded"),$(".athlete").find(".moreOverlay").removeClass("hidden"),$(".expander").removeClass("fa-minus-circle").addClass("fa-plus-circle"),e.find(".expander").removeClass("fa-plus-circle").addClass("fa-minus-circle"),e.find(".moreOverlay").addClass("hidden"),e.addClass("expanded")):"collapse"===t&&(e.find(".expander").removeClass("fa-minus-circle").addClass("fa-plus-circle"),e.find(".moreOverlay").removeClass("hidden"),e.removeClass("expanded"))}function o(e){var t=$(window).height(),a=$(window).scrollTop(),n=e.offset().top;(n>a+(t-200)||a>n)&&$("html, body").animate({scrollTop:n-150},500)}function d(){M=$("#olympians").isotope({layoutMode:"packery",itemSelector:".athlete",precentPosition:!0,transitionDuration:500})}function c(){for(i=0;i<m.length;i++)-1===$.inArray(m[i].sport,A)&&A.push(m[i].sport);for(i=0;i<A.length;i++){var e=A[i].toLowerCase();e=e.replace(/ |'|&/g,"");var t="<option data-selection='"+e+"'>"+A[i]+"</option>";$("#sports").append(t)}for(i=0;i<D.length;i++){var a=D[i]=D[i].toLowerCase();a=a.replace(/ |,|\./g,"");var n="<option data-selection='"+a+"'>"+D[i][0].toUpperCase()+D[i].substring(1)+"</option>";$("#dates").append(n)}}function p(e,t,a){$("#moreButtons").addClass("noShow"),filterString="."+e+"."+t+"."+a,M.isotope({filter:filterString}),$.each($(filterString),function(e,t){var a=$(this).children("img").attr("data-src");$(this).children("img").attr("src",a)}),0===$("#olympians").height()?$("h6.chatterHed").removeClass("noShow"):$("h6.chatterHed").addClass("noShow"),setTimeout(function(){$("#olympians").offset().top<$(window).scrollTop()&&$("html, body").animate({scrollTop:$("#olympians").offset().top-100},750)},600)}function h(e){$.each(e,function(e,t){S+=t.gold,T+=t.silver,B+=t.bronze}),$("#totalGold").text(S),$("#totalSilver").text(T),$("#totalBronze").text(B)}var u=new Date,v=u.getFullYear();u=Date.parse(u),$(".copyright").text(v);var f,m,g=0,x=d3.time.format("%Y-%m-%d"),b=d3.time.format("%b %d %Y"),C=d3.time.format("%B %e, %Y"),y=d3.time.format("%b. %e, %Y"),w=[],z=11,D=[],S=0,T=0,B=0;$.getJSON("http://interactives.dallasnews.com/data-store/2016/062016-texas-olympians-sked.json",function(a){f=a;var n=e(f[0].updated,C);for(f.shift(),$(".update").text(n),_.forEach(f,function(t,a){var n=e(t.nextdate,y);dateTime=n+", "+t.nexttime,jsDate=Date.parse(dateTime),t.jsDate=jsDate,t.next_date=n,t.gold=t.gold,t.silver=t.silver,t.bronze=t.bronze}),f=_.orderBy(f,"jsDate","asc"),i=0;i<f.length;i++)-1===$.inArray(f[i].next_date,D)&&D.push(f[i].next_date);var r;for(i=0;i<f.length;i++)f[i].jsDate<u&&(r=i);var s=f.splice(0,r);f=f.concat(s),g++,2===g&&t(m,f)}),$.getJSON("http://interactives.dallasnews.com/data-store/2016/062016-texas-olympians-athletes.json",function(e){m=e,g++,h(m),2===g&&t(m,f)}),$("#loadMore").click(function(){r(z)}),$("#loadAll").click(function(){r(1e3)});var M,A=[],L="athlete",F="athlete",O="athlete";$("#sports").change(function(){$(".athlete").addClass("visible"),L=$(this).find("option:selected").attr("data-selection"),p(L,F,O)}),$("#medals").change(function(){$(".athlete").addClass("visible"),F=$(this).find("option:selected").attr("data-selection"),p(L,F,O)}),$("#dates").change(function(){$(".athlete").addClass("visible"),O=$(this).find("option:selected").attr("data-selection"),p(L,F,O)}),$(window).scroll(function(){var e=$("#olympians").offset().top;$(window).scrollTop()>e?$("#filters").addClass("fixed"):$("#filters").removeClass("fixed")})});
//# sourceMappingURL=scripts-bundle.js.map
